task: train

defaults:
  - validation: ../validation

epoch: 50

trainer:
  _target_: lightning.pytorch.Trainer
  strategy:
    _target_: lightning.pytorch.strategies.DDPStrategy
    find_unused_parameters: false
  gradient_clip_val: 1.0  # Limitar gradientes para prevenir explosi√≥n

data:
  batch_size: 4
  image_size: ${image_size}
  cpu_num: ${cpu_num}
  shuffle: True
  pin_memory: True
  data_augment: {}

optimizer:
  type: AdamW
  args:
    lr: 0.001  # Incrementado 10x
    weight_decay: 0.005
    # momentum: 0.937
    # nesterov: true

loss:
  objective:
    BoxLoss: 7.5
    BCELoss: 0.5
    DFLoss: 1.5
    MaskLoss: 7.0 
  aux:
    0.25
  matcher:
    iou: CIoU
    topk: 10
    factor:
      iou: 6.0
      cls: 0.5

scheduler:
  type: CosineAnnealingLR
  warmup:
    epochs: 3.0
  args:
    T_max: ${task.epoch}
    eta_min: 0.00001

ema:
  enable: false
  decay: 0.9999
